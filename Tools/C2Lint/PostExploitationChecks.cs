using System;
using TeamServer.Models;

namespace C2Lint
{
    public class PostExploitationChecks
    {
        private readonly C2Profile.PostExploitationBlock _block;

        public PostExploitationChecks(C2Profile.PostExploitationBlock block)
        {
            _block = block;
        }

        public void CheckSpawnTo()
        {
            if (string.IsNullOrEmpty(_block.SpawnTo))
                Console.WriteLine("[!!!] No SpawnTo binary is defined.");
        }

        public void CheckAppDomain()
        {
            if (string.IsNullOrEmpty(_block.AppDomain))
            {
                Console.WriteLine($"[!!!] AppDomain is not defined.");
                return;
            }

            if (_block.AppDomain.Equals("random", StringComparison.OrdinalIgnoreCase))
                Console.WriteLine("AppDomain will have a random value each time.");
        }
    }
}